const Discord=require('discord.js'),c=require('chalk'),fs=require('fs'),delay=_0x3371a8=>new Promise(_0x5ae50d=>setTimeout(_0x5ae50d,_0x3371a8)),AccountLoading=require('../Functions/AccountLoading.js'),{Vec3}=require('vec3');let CurrentlyPlacing=![],PlacementCoords=[],PlacementBlock='netherrack',bots=[];var interaction;let findBlockRange=0x1e,mcData=null,stopped=![],Item=null,timer=0x1f4,gamemode='creative',blockReach=0x5,findCount=0x64,debug=![];async function startUp(_0x296793,_0x21910a){let _0x4db354=AccountLoading['loggedIn'];interaction=_0x296793;if(!_0x4db354['length'])return await _0x296793['editReply']({'content':'No\x20accounts\x20are\x20currenty\x20online.'});if(_0x21910a=='FindBlocks')return findBlocks();if(_0x21910a=='Start')return startPlacing();_0x21910a=='Stop'&&(stopped=!![],updateMessage(interaction,![],async function(){interaction['editReply']('Stopped\x20printing')['then'](_0x423c81=>{setTimeout(function(){_0x423c81['delete']();},0x9c4);});}));}async function findBlocks(){if(CurrentlyPlacing)return interaction['editReply']({'content':'You\x20can\x27t\x20do\x20this\x20while\x20the\x20bots\x20are\x20printing.'});getSelectedBots(async function(){if(mcData==null)mcData=require('minecraft-data')(bots[0x0]['botUser']['version']);if(Item==null)Item=require('prismarine-item')(bots[0x0]['botUser']['version']);try{PlacementCoords['splice'](0x0,PlacementCoords['length']),await bots[0x0]['botUser']['waitForChunksToLoad']();if(mcData['blocksByName'][PlacementBlock]===undefined)return interaction['editReply']({'content':'Block:\x20`'+PlacementBlock+'`\x20is\x20invalid.'});const _0x581445=[mcData['blocksByName'][PlacementBlock]['id']];let _0x50a5b7=bots[0x0]['botUser']['findBlocks']({'matching':_0x581445,'maxDistance':findBlockRange,'count':findCount});_0x50a5b7['forEach'](async _0x10265c=>{PlacementCoords['push'](_0x10265c);}),updateMessage(interaction,![],async function(){await interaction['editReply']({'content':'Successfully\x20found:\x20`'+PlacementCoords['length']+'`\x20guider\x20blocks!'})['then'](_0x80a7c7=>{setTimeout(function(){_0x80a7c7['delete']();},0x9c4);});});}catch(_0x2329d0){return console['log'](_0x2329d0);}});}async function startPlacing(){if(debug)console['log']('Loading...');if(!PlacementCoords['length'])return updateMessage(interaction,![],async function(){return await interaction['editReply']({'content':'You\x20don\x27t\x20have\x20any\x20guider\x20blocks\x20loaded.\x20Please\x20place\x20`'+PlacementBlock+'`,\x20and\x20use\x20\x27Find\x20Guider\x20Blocks\x27.'})['then'](_0x1c5e58=>{setTimeout(function(){_0x1c5e58['delete']();},0x1388);});});await getSelectedBots(async function(){if(mcData==null)mcData=require('minecraft-data')(bots[0x0]['botUser']['version']);if(Item==null)Item=require('prismarine-item')(bots[0x0]['botUser']['version']);await checkGamemode(async function(){await getSand(async function(){await getDistance(async function(){await getMode(async function(){await startPrinting();});});});});});}async function startPrinting(){bots['forEach'](async _0x4db7d1=>{if(stopped)return;for await(const _0x3a9355 of _0x4db7d1['Reachable']){if(stopped)return;if(_0x4db7d1['botUser']['blockAt'](_0x3a9355)['type']!==0x0)await _0x4db7d1['botUser']['placeBlock'](_0x4db7d1['botUser']['blockAt'](_0x3a9355),new Vec3(0x0,-0x1,0x0));else{if(_0x4db7d1['botUser']['blockAt'](_0x3a9355['offset'](0x1,0x0,0x0))['type']!==0x0)await _0x4db7d1['botUser']['placeBlock'](_0x4db7d1['botUser']['blockAt'](_0x3a9355['offset'](0x1,0x0,0x0)),new Vec3(-0x1,0x0,0x0));else{if(_0x4db7d1['botUser']['blockAt'](_0x3a9355['offset'](-0x1,0x0,0x0))['type']!==0x0)await _0x4db7d1['botUser']['placeBlock'](_0x4db7d1['botUser']['blockAt'](_0x3a9355['offset'](-0x1,0x0,0x0)),new Vec3(0x1,0x0,0x0));else{if(_0x4db7d1['botUser']['blockAt'](_0x3a9355['offset'](0x0,0x0,0x1))['type']!==0x0)await _0x4db7d1['botUser']['placeBlock'](_0x4db7d1['botUser']['blockAt'](_0x3a9355['offset'](0x0,0x0,0x1)),new Vec3(0x0,0x0,-0x1));else{if(_0x4db7d1['botUser']['blockAt'](_0x3a9355['offset'](0x0,0x0,-0x1))['type']!==0x0)await _0x4db7d1['botUser']['placeBlock'](_0x4db7d1['botUser']['blockAt'](_0x3a9355['offset'](0x0,0x0,-0x1)),new Vec3(0x0,0x0,0x1));}}}}}if(debug)console['log']('\x0a\x0a');}),!stopped?setTimeout(()=>{startPrinting();},timer):stopped=![];}async function getMode(_0x484989){if(debug)console['log']('getMode');await _0x484989();}async function getDistance(_0x5c2190){let _0x3317a0=bots['length'];for(var _0x3fc204=0x0;_0x3fc204<_0x3317a0;_0x3fc204++){if(debug)console['log'](bots[_0x3fc204]['botUser']['_client']['username']+':\x20');let _0x109005=[],_0x603cf1=JSON['parse'](JSON['stringify'](PlacementCoords));_0x603cf1['forEach'](async _0x5e9a64=>{_0x109005['push'](new Vec3(_0x5e9a64['x'],_0x5e9a64['y'],_0x5e9a64['z']));}),await _0x109005['forEach'](async _0x1ca899=>{if(bots[_0x3fc204]['botUser']['entity']['position']['distanceTo'](_0x1ca899)<blockReach){if(debug)console['log']('Within\x20reach:\x20'+_0x1ca899+'\x20('+bots[_0x3fc204]['botUser']['entity']['position']['distanceTo'](_0x1ca899)+')');bots[_0x3fc204]['Reachable']['push'](_0x1ca899);}else{if(debug)console['log']('Not\x20within\x20reach:\x20'+_0x1ca899+'\x20('+bots[_0x3fc204]['botUser']['entity']['position']['distanceTo'](_0x1ca899)+')');}});if(debug)await console['log']('checked');}await _0x5c2190();}async function getSand(_0x38af87){if(gamemode['toLowerCase']()=='creative')bots['forEach'](async(_0x274576,_0x29da53=0x0)=>{_0x29da53++;if(_0x29da53==bots['length'])_0x38af87();});else{}}async function checkGamemode(_0x2966f3){let _0x53dce2='survival';if(gamemode['toLowerCase']()=='survival')_0x53dce2='creative';let _0xe4f674=[];bots['forEach'](async(_0x201fd1,_0x1ca461=0x0)=>{_0x1ca461++;if(debug)console['log'](_0x201fd1['botUser']['username']+'\x20'+_0x201fd1['botUser']['game']['gameMode']);if(_0x201fd1['botUser']['game']['gameMode']['toLowerCase']()!=gamemode['toLowerCase']())_0xe4f674['push'](_0x201fd1['botUser']['username']);if(_0x1ca461==bots['length']){if(_0xe4f674['length'])updateMessage(interaction,![],async function(){return await interaction['editReply']({'content':'Bots:\x20`'+_0xe4f674['toString']()+'`\x20are\x20currently\x20in\x20'+_0x53dce2+'.\x20If\x20you\x20wish\x20to\x20print\x20while\x20in\x20'+_0x53dce2+',\x20please\x20change\x20the\x20gamemode\x20using\x20`.settings`.'});});else await _0x2966f3();}});}async function checkOccupationStatus(){}async function getSelectedBots(_0x42a766){if(debug)console['log']('getSelectedBots');let _0x546055=AccountLoading['loggedIn'],_0x6aa0ba=![];bots=[],_0x546055['forEach'](async(_0x2150f4,_0x861489=0x0)=>{if(_0x6aa0ba)return;_0x861489++;if(_0x2150f4['selected']){if(_0x2150f4['occupation']['currentlyOccupied']['busy'])return _0x6aa0ba=!![],interaction['editReply']({'content':'Bot:\x20`'+_0x2150f4['username']+'\x20is\x20currently\x20occupied\x20'+_0x2150f4['occupation']['currentlyOccupied']['occupation']+'`.\x20Please\x20either\x20deselect\x20this\x20account,\x20or\x20stop\x20its\x20current\x20tasks.'});else bots['push']({'botUser':_0x2150f4['botUser'],'Reachable':[]});}if(_0x861489==_0x546055['length'])await _0x42a766();});}async function getUsernames(_0x31fe11){if(debug)console['log']('getUsernames');getSelectedBots(async function(){let _0x416147='';bots['forEach'](async(_0xce3ec1,_0x24d7f9=0x0)=>{_0x24d7f9++,_0x416147=_0x416147+(_0x24d7f9+'.\x20'+_0xce3ec1['botUser']['username']+'\x0a');if(_0x24d7f9==bots['length'])await _0x31fe11(_0x416147);});});}async function updateMessage(_0x5bd4f1,_0xe3b822,_0x155247){fs['readFile']('./Settings.json','utf8',async function(_0x581e4c,_0x2efb57){await getUsernames(async function(_0x22d1d5){let _0x4fc574=_0x5bd4f1['message']['embeds'][0x0];_0x4fc574['setDescription']('1.\x20Place\x20guider\x20blocks\x20where\x20you\x20want\x20sand\x20to\x20be\x20printed.\x0a2.\x20Use\x20\x27Find\x20Guider\x20Blocks\x27\x20to\x20load\x20the\x20preset.\x0a\x0a(!)\x20If\x20you\x20break\x20the\x20guider\x20blocks\x20after\x20loading\x20the\x20preset,\x20sand\x20will\x20be\x20printed\x20where\x20the\x20guider\x20was.\x20If\x20you\x20leave\x20the\x20guiders\x20sand\x20will\x20print\x20under\x20them.\x0a\x0a'+('ðŸ”¸\x20`Guide\x20Block`\x0aâ¤·\x20**Block:**\x20'+PlacementBlock)+('\x0aâ¤·\x20**Found:**\x20'+PlacementCoords['length'])),_0x4fc574['fields'][0x0]['value']=_0x22d1d5;let _0x1c1798=_0x5bd4f1['message']['components'][0x0];_0xe3b822?(_0x1c1798['components'][0x0]['disabled']=!![],_0x1c1798['components'][0x1]['disabled']=![],_0x1c1798['components'][0x2]['disabled']=!![]):(_0x1c1798['components'][0x0]['disabled']=![],_0x1c1798['components'][0x1]['disabled']=!![],_0x1c1798['components'][0x2]['disabled']=![]);await _0x5bd4f1['message']['edit']({'embeds':[_0x4fc574],'components':[_0x1c1798]});if(_0x155247)await _0x155247();});});}module['exports']={'startUp':startUp,'PlacementCoords':PlacementCoords,'PlacementBlock':PlacementBlock};